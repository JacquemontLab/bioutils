#!/bin/bash


usage() {
  cat <<EOF
Usage: $(basename "$0") [OPTIONS]

Convert parquet file to csv

Options:
  -i, --input FILE      Input file path (required)
  -o, --output FILE     Output path to csv file
  -h, --help            Show this help message and exit

Example:
  $(basename "$0") --input data.txt --verbose
EOF
}

# Error message and exit
die() {
  echo "[ERROR] $*" >&2
  exit 1
}


# Parse arguments
while [[ $# -gt 0 ]]; do
  case "$1" in
    -i|--input)
      INPUT_FILE="$2"
      shift 2
      ;;
    -o|--output)
      OUTPUT_FILE="$2"
      shift 2
      ;;
    -h|--help)
      usage
      exit 0
      ;;
    -*)
      die "Unknown option: $1"
      ;;
    *)
      die "Unexpected argument: $1"
      ;;
  esac
done

[[ -z "$INPUT_FILE" ]] && die "Input file is required. Use -i or --input."


duckdb -c "COPY (SELECT * FROM "$INPUT_FILE") TO "$OUTPUT_FILE" (HEADER, DELIMITER '\t');"

